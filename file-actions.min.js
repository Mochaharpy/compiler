// @ts-nocheck
function startRename(e,t,i){e.isEditing=!0;const n=document.createElement("input");n.type="text",n.value=t.name,n.classList.add("rename-input"),n.addEventListener("blur",(()=>finishRename(e,t,n,i))),n.addEventListener("keydown",(l=>{"Enter"===l.key?finishRename(e,t,n,i):"Escape"===l.key&&cancelRename(e,i)})),i.replaceWith(n),n.select()}function isFilenameLegal(e){if(!e||0===e.length||e.length>255)return!1;const t=e.split(".")[0].toUpperCase();if(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"].includes(t))return!1;return!/[<>:"/\\|?*\x00-\x1F]/.test(e)&&(!(e.startsWith(" ")||e.endsWith(" ")||e.endsWith(".")||e.startsWith("."))&&("."!==e&&".."!==e))}function finishRename(e,t,i,n){e.isEditing=!1;const l=i.value.trim();l&&l!==t.name&&!isFileAlreadyExists(l)&&isFilenameLegal(l)?(t.name=l,n.textContent=l,i.replaceWith(n),e.dataset.fileName=l,t.uniqueId===firstHtmlFileId&&previewFirstHtmlFile()):cancelRename(e,n)}function cancelRename(e,t){e.isEditing=!1;const i=e.querySelector(".rename-input");if(i){const n=e.dataset.fileId,l=files[n];l&&(t.textContent=l.name),i.replaceWith(t)}}function isFileAlreadyExists(e){return Object.values(files).some((t=>t.name===e))}function setActiveFile(e){if(activeFile){activeFile.element.classList.remove("active"),activeFile.element.style.display="none";const e=document.querySelector("#tabs .tab.active");e&&e.classList.remove("active")}activeFile=e,activeFile.element.classList.add("active"),activeFile.element.style.display="block";const t=document.querySelector(`.tab[data-file-id="${e.uniqueId}"]`);t&&t.classList.add("active"),activeFile.editor&&activeFile.editor.layout()}function removeFile(e){if(activeFile===e){const t=Object.keys(files),i=t.indexOf(e.uniqueId);i>-1&&(t.splice(i,1),t.length>0?setActiveFile(files[t[0]]):activeFile=null)}const t=document.querySelector(`#tabs .tab[data-file-id="${e.uniqueId}"]`);if(t&&tabsDiv.removeChild(t),e.delete(),delete files[e.uniqueId],e.uniqueId===firstHtmlFileId){firstHtmlFileId=null;for(const e in files)if("html"===files[e].type){firstHtmlFileId=e,previewFirstHtmlFile();break}}else if(Object.keys(files).length>0&&null===firstHtmlFileId)for(const e in files)if("html"===files[e].type){firstHtmlFileId=e,previewFirstHtmlFile();break}}function findFileByPath(e){for(const t in files)if(files[t].name===e||files[t].uniqueId===e)return files[t];return null}function queryFileByName(e){return Object.values(files).find((t=>t.name===e))||null}function LocalFiles(e,t){const i=Object.values(t).flat().filter((e=>{try{return new URL(e),!1}catch{return!0}}));let n=[];return i.forEach((t=>{const i=Object.values(e).find((e=>e.name===t));i?n.push({name:t,code:i.getValue()}):console.warn(`⚠️  "${t}" declared but not found in files`)})),n}function getFileFromName(e){return Object.values(files).find((t=>t.name===e))||null}
